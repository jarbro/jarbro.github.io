<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <title>Why You No Have NTP?!</title>

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="description" content="">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Why You No Have NTP?!">
    <meta name="twitter:description" content="">

    <meta property="og:url" content="http://blog.jarbro.com">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Why You No Have NTP?!">
    <meta property="og:description" content="">
    <meta property="og:site_name" content="blog.jarbro">

    <meta itemprop="name" content="Why You No Have NTP?!">
    <meta itemprop="description" content="">

    <meta name="twitter:site" content="@yourblogtwitter">
    
    <meta name="twitter:creator" content="@yourtwitter">
    
    <meta property="article:author" content="https://www.facebook.com/yourprofile">
    
    <meta property="article:publisher" content="https://www.facebook.com/yourblogprofile">
    
    <meta property="fb:admins" content="">
    
    <meta name="google-site-verification" content="">
    
    <link rel="author" href="https://plus.google.com/yourprofile">
    
    <meta name="theme-color" content="">

    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link href="/apple-touch-icon-precomposed.png" rel="apple-touch-icon">

    <link href="//fonts.googleapis.com/" rel="dns-prefetch">
    <link href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400&subset=latin,latin-ext" rel="stylesheet">

    <link rel="stylesheet" href="//blog.jarbro.com/themes/ghostium/assets/css/main.min.css?v=1552658566720">
    <link rel="stylesheet" href="//blog.jarbro.com/themes/ghostium/assets/css/asciidoctor-foundation.css?v=1552658566720"/>

    <script type="text/javascript">
      var ga_ua = 'UA-XXXXX-X';
      
      var disqus_shortname = 'example';
      
      var enable_pjax = true;

      // Pace Options
      // ==============
      window.paceOptions = {
        catchupTime: 100,
        minTime: 100,
        elements: false,
        restartOnRequestAfter: 500,
        startOnPageLoad: false
      }

      // Ghostium Globals
      // ==============
      window.GHOSTIUM = {};
      GHOSTIUM.haveGA = typeof ga_ua !== 'undefined' && ga_ua !== 'UA-XXXXX-X';
      GHOSTIUM.haveDisqus = typeof disqus_shortname !== 'undefined' && disqus_shortname !== 'example';
      GHOSTIUM.enablePjax = typeof enable_pjax !== 'undefined' ? enable_pjax : true;
    </script>

    <script src="//blog.jarbro.com/themes/ghostium/assets/js/head-scripts.min.js?v=1552658566720"></script>

    <link rel="canonical" href="http://blog.jarbro.com/2017/06/07/Why-You-No-Have-NTP.html" />
    <meta name="referrer" content="origin" />
    
    <meta property="og:site_name" content="blog.jarbro" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Why You No Have NTP?!" />
    <meta property="og:description" content="A few months back I had to replace one of our switches.  Shortly afterwards I began getting complaints that users workstations clocks were off by a minute here, a minute there.  It wasn&amp;#8217;t affecting the entire network, only a small subset of users. At first I was convinced" />
    <meta property="og:url" content="http://blog.jarbro.com/2017/06/07/Why-You-No-Have-NTP.html" />
    <meta property="article:published_time" content="2017-06-07T00:00:00.000Z" />
    <meta property="article:tag" content="NETWORKING" />
    <meta property="article:tag" content="NTP" />
    <meta property="article:tag" content="SWITCHING" />
    <meta property="article:tag" content="PROCURVE" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Why You No Have NTP?!" />
    <meta name="twitter:description" content="A few months back I had to replace one of our switches.  Shortly afterwards I began getting complaints that users workstations clocks were off by a minute here, a minute there.  It wasn&amp;#8217;t affecting the entire network, only a small subset of users. At first I was convinced" />
    <meta name="twitter:url" content="http://blog.jarbro.com/2017/06/07/Why-You-No-Have-NTP.html" />
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "blog.jarbro",
    "author": {
        "@type": "Person",
        "name": "Jared Brodsky",
        "image": "https://avatars2.githubusercontent.com/u/3271673?v=4",
        "url": "http://blog.jarbro.com/author/jarbro/",
        "sameAs": "blog.jarbro.com",
        "description": "nothing to see here, move along."
    },
    "headline": "Why You No Have NTP?!",
    "url": "http://blog.jarbro.com/2017/06/07/Why-You-No-Have-NTP.html",
    "datePublished": "2017-06-07T00:00:00.000Z",
    "keywords": "NETWORKING, NTP, SWITCHING, PROCURVE",
    "description": "A few months back I had to replace one of our switches.  Shortly afterwards I began getting complaints that users workstations clocks were off by a minute here, a minute there.  It wasn&amp;#8217;t affecting the entire network, only a small subset of users. At first I was convinced"
}
    </script>

    <meta name="generator" content="HubPress" />
    <link rel="alternate" type="application/rss+xml" title="blog.jarbro" href="http://blog.jarbro.com/rss/" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/themes/prism-okaidia.min.css">
    
        <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
  </head>
  <body class="post-template tag-NETWORKING tag-NTP tag-SWITCHING tag-PROCURVE">

    <button data-action="open-drawer" id="drawer-button" class="drawer-button"><i class="fa fa-bars"></i></button>
    <nav tabindex="-1" class="drawer">
      <div class="drawer-container">
        <!--.drawer-search(role="search")-->
        <ul role="navigation" class="drawer-list">
          
          <li class="drawer-list-item">
            <a href="/" data-pjax>
              <i class="fa fa-home"></i>Home
            </a>
          </li>
          <li class="drawer-list-item">
            <a href="http://blog.jarbro.com/rss/">
              <i class="fa fa-rss"></i>Subscribe to Feed
            </a>
          </li>
          <li class="drawer-list-divider"></li>
          <li class="drawer-list-item drawer-list-title">
            Follow me
          </li>
          
          
          <li class="drawer-list-item">
            <a href="jarbro" title="Twitter" target="_blank">
              <i class="fa fa-twitter"></i>Twitter
            </a>
          </li>
          <li class="drawer-list-item">
            <a href="jarbro" title="Github" target="_blank">
              <i class="fa fa-github"></i>Github
            </a>
          </li>
          <li class="drawer-list-item">
            <a href="jarbro" title="Facebook" target="_blank">
              <i class="fa fa-facebook"></i>Facebook
            </a>
          </li>
          <li class="drawer-list-item">
            <a href="jarbro" title="Instagram" target="_blank">
              <i class="fa fa-instagram"></i>Instagram
            </a>
          </li>
          <li class="drawer-list-item">
            <a href="jaredbrodsky" title="LinkedIn" target="_blank">
              <i class="fa fa-linkedin"></i>LinkedIn
            </a>
          </li>
        </ul>
      </div>
    </nav>

    <div class="drawer-overlay"></div>
    <main id="container" role="main" class="container">
      <div class="surface">
        <div class="surface-container">
          <div data-pjax-container class="content">
            
<section class="wrapper wrapper-post">
  <div class="wrapper-container">
    <article itemscope itemtype="http://schema.org/BlogPosting" role="article" class="post post tag-NETWORKING tag-NTP tag-SWITCHING tag-PROCURVE">
        <section class="post-container">
          <header class="post-header">
            <ul class="post-meta-list">
              <li class="post-meta-item">
                <time datetime="2017-06-07" itemprop="datePublished">
                  2 years ago
                </time>
              </li>
                <li class="post-meta-item">
                    <a itemprop="articleSection" href="/" data-pjax>NETWORKING</a>, 
                    <a itemprop="keywords" href="/" data-pjax>NTP</a>, 
                    <a itemprop="keywords" href="/" data-pjax>SWITCHING</a>, 
                    <a itemprop="keywords" href="/" data-pjax>PROCURVE</a> 
                </li>
              <li class="post-meta-item">
                <a href="#disqus_thread" data-disqus-identifier="">Comments</a>
              </li>
            </ul>
            <h1 itemprop="name headline" class="post-title"><a href="/" itemprop="url" data-pjax title="Why You No Have NTP?!">Why You No Have NTP?!</a></h1>
            <!--h2 itemprop="about" class="post-subtitle"></h2-->
          </header>
          <aside class="post-side">
            <div class="post-author">
                <a href="blog.jarbro.com" class="post-author-avatar">
                  <img src="https://avatars2.githubusercontent.com/u/3271673?v&#x3D;4" alt="Jared Brodsky">
                </a>
              <div class="post-author-info">
                <a href="blog.jarbro.com" class="post-author-name">
                  Jared Brodsky
                </a>
                <p class="post-author-bio">nothing to see here, move along.</p>
              </div>
            </div>
          </aside>
          <div itemprop="articleBody" class="post-body">
            <div class="paragraph">
<p>A few months back I had to replace one of our switches.  Shortly afterwards I began getting complaints that users workstations clocks were off by a minute here, a minute there.  It wasn&#8217;t affecting the entire network, only a small subset of users.</p>
</div>
<div class="paragraph">
<p>At first I was convinced it was my firewall blocking NTP traffic, but packet captures at the edge turned up nothing.  Packet captures from an affected host showed the outbound NTP requests going out, but no NTP response.</p>
</div>
<div class="paragraph">
<p>After some additional physical network testing I narrowed it down to an HP Procurve V1810-48G switch which has a lovely feature called Auto DoS.</p>
</div>
<div class="paragraph">
<p>In a nutshell enabling Auto DoS will hose some of your network services.</p>
</div>
<div class="paragraph">
<p>A single checkbox started <strong>blackholing</strong> my NTP traffic and their documentation simply labels the box as <em>Select Enable to enable denial of service attack protection, or clear to disable DoS protection.</em> While it is disabled by default, for some reason, mine was <em>enabled</em>.</p>
</div>
<div class="paragraph">
<p>While I congratulate HP engineers for at least understanding the need for implementing security on L2, this particular implementation cost me a fair amount of time in troubleshooting and a huge headache.</p>
</div>
<div class="paragraph">
<p>Long story short</p>
</div>
<div class="paragraph">
<p>Disable Auto DoS and things should go back to normal.</p>
</div>
<div class="paragraph">
<p>For reference, this is what enabling Auto DoS actually does.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Auto DoS</p>
</div>
<div class="paragraph">
<p>Enable – Select to prevent receiving packets from the all attacks mentioned below (Default: Disabled).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Prevent Land Attack – Prevents receiving packets with matching Source and Destination IP addresses.</p>
</li>
<li>
<p>Prevent TCP Blat Attack – TCP Source and Destination Port match</p>
</li>
<li>
<p>Prevent UDP Blat Attack – UDP Source and Destination Port match</p>
</li>
<li>
<p>Prevent Ping Of Death Attack – Prevents receiving ping packets with a size larger than 512 bytes through the use of fragments, which can target vulnerable systems.</p>
</li>
<li>
<p>Prevent Invalid TCP Flags Attack – Prevents receiving packets with invalid TCP flags. TCP Flag SYN set and Source Port less than 1024 or TCP Control Flags = 0 and * TCP Sequence Number = 0 or TCP Flags FIN, URG, and PSH set and TCP Sequence Number = 0 or TCP Flags SYN and FIN set.</p>
</li>
<li>
<p>Prevent TCP Fragment Attack – Drop IP Packets that have a TCP header less than 20 bytes.</p>
</li>
<li>
<p>Check First Fragment Only – Enable checking DOS attacks on IP first fragments</p>
</li>
<li>
<p>Prevent Smurf Attack – ICMP Echo packets (ping) to a broadcast IP address are dropped.</p>
</li>
<li>
<p>Prevent Ping Flood Attack – Prevents Ping Flood by limiting the number of ICMP Ping packets. The rate is 1000 ICMP packets per second.</p>
</li>
<li>
<p>Prevent Syn Flood Attack – A SYN flood attack sends TCP connections requests faster than a machine can process them. Setting this filter limits the rate of TCP connection requests.</p>
</li>
</ul>
</div>
</blockquote>
</div>
          </div>
          <footer class="post-footer">
            <div itemprop="author" itemscope itemtype="http://schema.org/Person" class="post-author">
                <a href="blog.jarbro.com" class="post-author-avatar">
                  <img itemprop="image" src="https://avatars2.githubusercontent.com/u/3271673?v&#x3D;4" alt="Jared Brodsky">
                </a>
              <div class="post-author-info">
                <h4 class="post-footer-heading">Written By</h4>
                <a href="blog.jarbro.com" itemprop="url" class="post-author-name">
                  <span itemprop="name">Jared Brodsky</span>
                </a>
                <p itemprop="description" class="post-author-bio">nothing to see here, move along.</p>
                  <p class="post-author-location">I ❤︎ NYC</p>
                  <p class="post-author-website">
                    <a href="blog.jarbro.com" rel="nofollow">blog.jarbro.com</a>
                  </p>
                <p class="post-info">
                  <b class="post-info-title">Published on</b>
                  <time class="post-date">June 07, 2017</time>
                </p>
              </div>
            </div>
            <div class="post-social">
              <h4 class="post-footer-heading">Spread the word</h4>
              <a href="#" data-action="share-twitter"><i class="fa fa-fw fa-lg fa-twitter"></i></a>
              <a href="#" data-action="share-facebook"><i class="fa fa-fw fa-lg fa-facebook"></i></a>
              <a href="#" data-action="share-gplus"><i class="fa fa-fw fa-lg fa-google-plus"></i></a>
            </div>
          </footer>
        </section>

      <section class="post-comments">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
        var disqus_shortname = 'jarbro'; // required: replace example with your forum shortname
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </section>

    </article>

    <footer role="contentinfo" class="footer">
      <p><small>© 2019. All Rights Reserved.</small></p>
      <p><small><a href="http://ghostium.oswaldoacauan.com/" target="_blank">Ghostium Theme</a> by <a href="http://twitter.com/oswaldoacauan" target="_blank">@oswaldoacauan</a></small></p>
      <p><small>Proudly published with <a href="https://hubpress.github.io" target="_blank">HubPress</a></small></p>
    </footer>
  </div>
</section>


          </div>
        </div>
      </div>
    </main>


    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/prism.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        // hljs.initHighlightingOnLoad();
      </script>

    <script src="//blog.jarbro.com/themes/ghostium/assets/js/foot-scripts.min.js?v=1552658566720"></script>

    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-71227-21', 'auto');
    ga('send', 'pageview');

    </script>
  </body>
</html>
